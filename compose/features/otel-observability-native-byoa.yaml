version: '3.9'
x-omnistrate-byoa: # Customer-Account
  AwsAccountId: '339713121445'
  AwsBootstrapRoleAccountArn: 'arn:aws:iam::339713121445:role/omnistrate-bootstrap-role'
x-internal-integrations:
  # Do not include metrics due to high amount of data and cost implications
  # metrics:
  #   provider: native
  #   serviceComponentsConfiguration:
  #    promexporter:
  #      prometheusEndpoint: "http://localhost:8080/metrics"
  logs:
    provider: native
services:
  postgres:
    image: postgres
    ports:
      - '5432:5432'
    environment:
      - SECURITY_CONTEXT_USER_ID=999
      - SECURITY_CONTEXT_GROUP_ID=999
      - POSTGRES_USER=username
      - POSTGRES_PASSWORD=password
      - PGDATA=/var/lib/postgresql/data/dbdata
    volumes:
      - ./data:/var/lib/postgresql/data
    x-omnistrate-compute:
      instanceTypes:
        - cloudProvider: azure
          name: Standard_B2ms
  promexporter:
    image: quay.io/brancz/prometheus-example-app:v0.5.0
    ports:
      - '8080'
    x-omnistrate-mode-internal: true
